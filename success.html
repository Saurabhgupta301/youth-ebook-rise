import express from 'express';
import { Resend } from 'resend';
import dotenv from 'dotenv';

dotenv.config();
const app = express();
app.use(express.json());

const resend = new Resend(process.env.RESEND_API_KEY);

app.post('/send-ebook', async (req, res) => {
  const { email } = req.body;
  try {
    const data = await resend.emails.send({
      from: 'Youth E-Book <noreply@youthebookrise.com>',
      to: email,
      subject: 'Your Youth E-Book â€“ 1 Crore in 365 Days',
      html: `
        <p>Hi ðŸ‘‹</p>
        <p>Thank you for purchasing the Youth E-Book Rise ðŸŽ‰</p>
        <p><a href="https://youth-ebook-rise.onrender.com/ebook.pdf" 
              style="background:#ff1493;color:white;padding:10px 15px;
              text-decoration:none;border-radius:5px;">ðŸ“¥ Download eBook</a></p>
        <p>Happy learning,<br>Team Youth E-Book Rise</p>
      `,
    });
    res.json({ success: true, data });
  } catch (error) {
    console.error(error);
    res.status(500).json({ success: false, error });
  }
});

app.listen(3000, () => console.log('Server running on port 3000'));
